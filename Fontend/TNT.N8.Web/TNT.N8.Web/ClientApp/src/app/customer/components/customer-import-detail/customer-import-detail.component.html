<div class="loading-indicator" *ngIf="loading">
  <p-progressSpinner [style]="{ width: '50px', height: '50px' }" strokeWidth="8" fill="#EEEEEE" animationDuration=".5s">
  </p-progressSpinner>
</div>
<!-- Confirm... -->
<p-confirmDialog header="Xác nhận" icon="pi pi-exclamation-triangle" acceptLabel="Chấp nhận" rejectLabel="Không">
</p-confirmDialog>

<section class="customer-import-detail">
  <p-table [columns]="columns" [value]="listCustomerImport" [scrollable]="true" scrollHeight="300px"
    selectionMode="multiple" [(selection)]="selectedCustomerImport" [resizableColumns]="true" [style]="{width:'100%'}"
    [paginator]="true" [rows]="10" [rowsPerPageOptions]="[10,50,100]">
    <ng-template pTemplate="colgroup" let-columns>
      <colgroup>
        <col *ngFor="let col of columns">
      </colgroup>
    </ng-template>
    <ng-template pTemplate="header" let-columns>
      <tr>
        <th style="width: 3em;">
          <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
        </th>
        <th *ngFor="let col of columns" pResizableColumn [ngSwitch]="col.field"
          [ngStyle]="{'width': col.width, 'text-align': 'center'}">
          <span *ngSwitchCase="'lastName'">
            {{col.header}}<span class="required">*</span>
          </span>
          <span *ngSwitchCase="'customerCode'">
            {{col.header}}<span class="required">*</span>
          </span>
          <span *ngSwitchDefault>
            {{col.header}}
          </span>
        </th>
      </tr>
    </ng-template>

    <ng-template late pTemplate="body" let-rowData let-columns="columns">
      <tr [style.color]="!rowData.isValid ? 'red' : 'black' ">
        <td style="width: 3em;">
          <p-tableCheckbox [value]="rowData"></p-tableCheckbox>
        </td>
        <td *ngFor="let col of columns;" class="ui-resizable-column"
          [ngStyle]="{'width': col.width, 'text-align': col.textAlign}" [ngSwitch]="col.field" pEditableColumn>

          <p-cellEditor *ngSwitchCase="'firstName'">
            <ng-template pTemplate="input">
              <input (change)="checkStatus(true)" pInputText placeholder="" type="text" [(ngModel)]="rowData[col.field]" maxlength="250" />
            </ng-template>
            <ng-template pTemplate="output">
              {{rowData[col.field]}}
            </ng-template>
          </p-cellEditor>

          <p-cellEditor *ngSwitchCase="'lastName'">
            <ng-template pTemplate="input">
              <input (change)="checkStatus(true)" pInputText placeholder="" type="text" [(ngModel)]="rowData[col.field]" maxlength="250"/>
            </ng-template>
            <ng-template pTemplate="output">
              {{rowData[col.field]}}
            </ng-template>
          </p-cellEditor>

          <p-cellEditor *ngSwitchCase="'isEmployee'">
            <ng-template pTemplate="input">
              <p-checkbox [(ngModel)]="rowData[col.field]" [binary]="true"></p-checkbox>
            </ng-template>
            <ng-template pTemplate="output">
              <p-checkbox [(ngModel)]="rowData[col.field]" [binary]="true"></p-checkbox>
            </ng-template>
          </p-cellEditor>

          <p-cellEditor *ngSwitchCase="'isVendor'">
            <ng-template pTemplate="input">
              <p-checkbox [(ngModel)]="rowData[col.field]" [binary]="true"></p-checkbox>
            </ng-template>
            <ng-template pTemplate="output">
              <p-checkbox [(ngModel)]="rowData[col.field]" [binary]="true"></p-checkbox>
            </ng-template>
          </p-cellEditor>

          <p-cellEditor *ngSwitchCase="'customerCode'">
            <ng-template pTemplate="input">
              <input (change)="checkStatus(true)" pInputText placeholder="" type="text" [(ngModel)]="rowData[col.field]" />
            </ng-template>
            <ng-template pTemplate="output">
              {{rowData[col.field]}}
            </ng-template>
          </p-cellEditor>

          <p-cellEditor *ngSwitchCase="'isCompany'">
            <ng-template pTemplate="input">
              <p-checkbox [(ngModel)]="rowData[col.field]" [binary]="true"></p-checkbox>
            </ng-template>
            <ng-template pTemplate="output">
              <p-checkbox [(ngModel)]="rowData[col.field]" [binary]="true"></p-checkbox>
            </ng-template>
          </p-cellEditor>

          <p-cellEditor *ngSwitchCase="'companyName'">
            <ng-template pTemplate="input">
              <input (change)="checkStatus(true)" pInputText placeholder="" type="text" [(ngModel)]="rowData[col.field]" />
            </ng-template>
            <ng-template pTemplate="output">
              {{rowData[col.field]}}
            </ng-template>
          </p-cellEditor>

          <p-cellEditor *ngSwitchCase="'address'">
            <ng-template pTemplate="input">
              <input (change)="checkStatus(true)" pInputText placeholder="" type="text" [(ngModel)]="rowData[col.field]" />
            </ng-template>
            <ng-template pTemplate="output">
              {{rowData[col.field]}}
            </ng-template>
          </p-cellEditor>

          <p-cellEditor *ngSwitchCase="'taxCode'">
            <ng-template pTemplate="input">
              <input (change)="checkStatus(true)" pInputText placeholder="" type="text" [(ngModel)]="rowData[col.field]" />
            </ng-template>
            <ng-template pTemplate="output">
              {{rowData[col.field]}}
            </ng-template>
          </p-cellEditor>

          <p-cellEditor *ngSwitchCase="'phone'">
            <ng-template pTemplate="input">
              <input (change)="checkStatus(true)" pInputText placeholder="" type="text" [(ngModel)]="rowData[col.field]" />
            </ng-template>
            <ng-template pTemplate="output">
              {{rowData[col.field]}}
            </ng-template>
          </p-cellEditor>

          <p-cellEditor *ngSwitchCase="'email'">
            <ng-template pTemplate="input">
              <input (change)="checkStatus(true)" pInputText placeholder="" type="text" [(ngModel)]="rowData[col.field]" />
            </ng-template>
            <ng-template pTemplate="output">
              {{rowData[col.field]}}
            </ng-template>
          </p-cellEditor>

          <p-cellEditor *ngSwitchCase="'fullNameOfContact'">
            <ng-template pTemplate="input">
              <input (change)="checkStatus(true)" pInputText placeholder="" type="text" [(ngModel)]="rowData[col.field]" />
            </ng-template>
            <ng-template pTemplate="output">
              {{rowData[col.field]}}
            </ng-template>
          </p-cellEditor>

          <p-cellEditor *ngSwitchCase="'genderOfContact'">
            <ng-template pTemplate="input">
              <p-dropdown [options]="listGender" optionLabel="name" [(ngModel)]="rowData.selectedValueGender"
                [filter]="true" [showClear]="true" [resetFilterOnHide]="true" [autoDisplayFirst]="false"
                [style]="{'width':'100%'}" appendTo="body" baseZIndex="99999"></p-dropdown>
            </ng-template>
            <ng-template pTemplate="output">
              {{rowData.selectedValueGender ? rowData.selectedValueGender.name : rowData[col.field] }}
            </ng-template>
          </p-cellEditor>

          <p-cellEditor *ngSwitchCase="'addressOfContact'">
            <ng-template pTemplate="input">
              <input (change)="checkStatus(true)" pInputText placeholder="" type="text" [(ngModel)]="rowData[col.field]" />
            </ng-template>
            <ng-template pTemplate="output">
              {{rowData[col.field]}}
            </ng-template>
          </p-cellEditor>

          <p-cellEditor *ngSwitchCase="'phoneOfContact'">
            <ng-template pTemplate="input">
              <input (change)="checkStatus(true)" pInputText placeholder="" type="text" [(ngModel)]="rowData[col.field]" />
            </ng-template>
            <ng-template pTemplate="output">
              {{rowData[col.field]}}
            </ng-template>
          </p-cellEditor>

          <p-cellEditor *ngSwitchCase="'emailOfContact'">
            <ng-template pTemplate="input">
              <input (change)="checkStatus(true)" pInputText placeholder="" type="text" [(ngModel)]="rowData[col.field]" />
            </ng-template>
            <ng-template pTemplate="output">
              {{rowData[col.field]}}
            </ng-template>
          </p-cellEditor>

          <p-cellEditor *ngSwitchCase="'note'">
            <ng-template pTemplate="input">
              <input (change)="checkStatus(true)" pInputText placeholder="" type="text" [(ngModel)]="rowData[col.field]" />
            </ng-template>
            <ng-template pTemplate="output">
              {{rowData[col.field]}}
            </ng-template>
          </p-cellEditor>

          <div *ngSwitchCase="'listStatus'">
            <ul>
              <li *ngFor="let status of rowData[col.field]; let i=index">
                <span>{{status.name}}</span>
              </li>
            </ul>
          </div>

          <div *ngSwitchDefault>
            {{rowData[col.field]}}
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>
  <div class="buttons" style="padding-top: 1rem; display: flex; justify-content: flex-end;">
    <button type="button" class="btn-remove" style="margin-right: 0.75rem;" (click)="onCancel()">
      <span class="btn-remove-text">Hủy</span>
    </button>
    <button type="button" class="btn-save" (click)="importCustomer()">
      <span class="btn-save-text">Lưu</span>
    </button>
  </div>
</section>
